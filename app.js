const StorageCtrl={storeItem:function(e){let t;null===localStorage.getItem("items")?(t=[],t.push(e),localStorage.setItem("items",JSON.stringify(t))):(t=JSON.parse(localStorage.getItem("items")),t.push(e),localStorage.setItem("items",JSON.stringify(t)))},getItemFromStorage:function(){let e;return e=null===localStorage.getItem("items")?[]:JSON.parse(localStorage.getItem("items")),e},updateItemStorage:function(e){let t=JSON.parse(localStorage.getItem("items"));t.forEach(((n,o)=>{e.id===n.id&&t.splice(o,1,e)})),localStorage.setItem("items",JSON.stringify(t))},deleteItemStorage:function(e){let t=JSON.parse(localStorage.getItem("items"));t.forEach(((n,o)=>{e===n.id&&t.splice(o,1)})),localStorage.setItem("items",JSON.stringify(t))},removeAllItems:function(){localStorage.removeItem("items")}},ItemCtrl=function(){const e=function(e,n){this.id=t.next().value,this.calories=n,this.name=e};const t=function*(){let e=1;for(;;)yield e++}(),n={items:StorageCtrl.getItemFromStorage(),currentItem:null,totalCalories:0};return{getItems:function(){return n.items},logData:function(){return n},addItem:function(t,o){const i=new e(t,parseInt(o));return n.items.push(i),i},getTotCalories:function(){let e=0;return n.items.forEach((t=>{e+=t.calories})),n.totalCalories=e,n.totalCalories},getItemByID:function(e){let t=null;return n.items.forEach((n=>{n.id===e&&(t=n)})),t},updateItemByID:function(e,t,o){let i=null;return n.items.forEach((n=>{n.id===e&&(n.name=t,n.calories=parseInt(o),i=n)})),i},setCurrentItem:function(e){n.currentItem=e},getCurrentItem:function(){return n.currentItem},itemToBeDeleted:function(e){const t=n.items.map((e=>e.id)).indexOf(e);n.items.splice(t,1)},clearAllItems:function(){n.items=[]}}}(),UICrtl=function(){const e={itemList:"#item-list",listItems:"#item-list li",addBtn:".add-btn",updateBtn:".update-btn",deleteBtn:".delete-btn",backBtn:".back-btn",clearBtn:".clear-btn",itemNameInput:"#item-name",itemCaloriesInput:"#item-calories",totalCalories:".total-calories"};return{populateItemList:function(t){let n="";t.forEach((e=>{n+=`<li class="collection-item" id="item-${e.id}">\n              <strong>${e.name}</strong> - <em>${e.calories} calories</em>\n              <a href=3"" class="secondary-content"><i class="edit-item fa fa-pencil"></i></a>\n          </li>`})),document.querySelector(e.itemList).innerHTML=n},clearEditState:function(){UICrtl.clearInputs(),document.querySelector(e.updateBtn).style.display="none",document.querySelector(e.deleteBtn).style.display="none",document.querySelector(e.backBtn).style.display="none",document.querySelector(e.addBtn).style.display="inline"},showEditState:function(){document.querySelector(e.updateBtn).style.display="inline",document.querySelector(e.deleteBtn).style.display="inline",document.querySelector(e.backBtn).style.display="inline",document.querySelector(e.addBtn).style.display="none"},getSelectors:function(){return e},getItemInput:function(){return{name:document.querySelector(e.itemNameInput).value,calories:document.querySelector(e.itemCaloriesInput).value}},addListItem(t){const n=document.createElement("li");n.className="collection-item",n.id=`item-${t.id}`,n.innerHTML=`\n      <strong>${t.name}</strong> - <em>${t.calories} calories</em>\n      <a href=3"" class="secondary-content">\n      <i class="edit-item fa fa-pencil"></i></a>`,document.querySelector(e.itemList).insertAdjacentElement("beforeend",n)},clearInputs:function(){document.querySelector(e.itemNameInput).value="",document.querySelector(e.itemCaloriesInput).value=""},statusList:function(t){document.querySelector(e.itemList).style.display=t},updateTotCalories:function(t){document.querySelector(e.totalCalories).innerHTML=t},addItemToForm:function(){const t=ItemCtrl.getCurrentItem();document.querySelector(e.itemNameInput).value=t.name,document.querySelector(e.itemCaloriesInput).value=t.calories,UICrtl.showEditState()},updateListItem:function(e){const t=document.querySelectorAll("#item-list li");Array.from(t).forEach((t=>{t.getAttribute("id")===`item-${parseInt(e.id)}`&&(t.innerHTML=`\n            <strong>${e.name}</strong> - <em>${e.calories} calories</em>\n            <a href=3"" class="secondary-content">\n            <i class="edit-item fa fa-pencil"></i></a>`)}))},removeLiItem:function(e){const t=`#item-${e}`;document.querySelector(t).remove()},removeAllItems:function(){document.getElementById("item-list").innerHTML=""}}}(),App=function(e,t,n){const o=function(o){const i=n.getItemInput();if(""!==i.name&&""!==i.calories){const o=e.addItem(i.name,i.calories);n.addListItem(o);const r=e.getTotCalories();n.updateTotCalories(r),n.statusList("block"),t.storeItem(o),n.clearInputs()}o.preventDefault()},i=function(t){if(t.target.classList.contains("edit-item")){const o=t.target.parentNode.parentNode.id.split("-"),i=parseInt(o[1]),r=e.getItemByID(i);e.setCurrentItem(r),n.addItemToForm()}t.preventDefault()},r=function(o){const i=n.getItemInput(),r=e.getCurrentItem().id,l=e.updateItemByID(r,i.name,i.calories);n.updateListItem(l);const a=e.getTotCalories();n.updateTotCalories(a),n.clearEditState(),t.updateItemStorage(l),n.clearInputs(),o.preventDefault()},l=function(o){const i=e.getCurrentItem().id;e.itemToBeDeleted(i),n.removeLiItem(i);const r=e.getTotCalories();n.updateTotCalories(r),t.deleteItemStorage(i),n.clearEditState(),o.preventDefault()},a=function(o){e.clearAllItems(),n.removeAllItems(),t.removeAllItems();const i=e.getTotCalories();n.updateTotCalories(i),n.statusList("none"),o.preventDefault()};return{init:function(){n.clearEditState();const t=e.getItems(),c=e.getTotCalories();n.updateTotCalories(c),0===t.length?n.statusList("none"):n.populateItemList(t),function(){const e=n.getSelectors();document.querySelector(e.addBtn).addEventListener("click",o),document.querySelector(e.itemList).addEventListener("click",i),document.querySelector(e.updateBtn).addEventListener("click",r),document.querySelector(e.backBtn).addEventListener("click",(function(e){n.clearEditState(),e.preventDefault()})),document.querySelector(e.deleteBtn).addEventListener("click",l),document.querySelector(e.clearBtn).addEventListener("click",a),document.addEventListener("keypress",(function(e){if(13===e.keyCode||13===e.which)return e.preventDefault(),!1}))}()}}}(ItemCtrl,StorageCtrl,UICrtl);App.init();
